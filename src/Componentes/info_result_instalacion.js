import * as React from 'react';
import { StyleSheet, Text, View, TouchableOpacity, Dimensions, LogBox} from 'react-native';
import tec2 from '../../assets/tec3.jpg'; 
import ImageOverlay from "react-native-image-overlay";
import Icon from 'react-native-vector-icons/FontAwesome';
import Fire, {db} from '../../fire';


var {height} = Dimensions.get('window');
var key


export class InfoResultInsta extends React.Component {

  constructor() {
    
   
    super();
    this.state = {
      todos: {},
      presentToDo: '',
      key:''
      
    };
    
  }

  
  
  viabilidadTotal() {

   
    LogBox.ignoreLogs(["Setting a timer"]);

     //db.ref('/Usuario').on('child_added', querySnapShot => {
     //key = querySnapShot.key;
            
     console.log('this.state.key: ',this.state.key)
     
      //console.warn('todoitems', todoItems)
      
    //});
    
     db.ref('/Usuarios/' + this.state.key).update({
      Viabilidad: '100%'
      
    })

    // Get the unique key generated by push()
    //var postId = newPostRef.key;
    //console.warn(postId)
       
    this.setState({
      presentToDo: '',
    });
  }
    
     

  viabilidadParcial() {
    db.ref('/Usuarios/' + this.state.key).update({
      Viabilidad: '50%'
         });
      
    
    this.setState({
      presentToDo: '',
    });
  }



  noViable() {
    db.ref('/Usuarios/' + this.state.key).update({
      Viabilidad: '0%',
      uid: Fire.getUid()
      
    });
       
    this.setState({
      presentToDo: '',
    });
  }

  
  evaluando() {
    db.ref('/Usuarios/' + this.state.key).update({
      Viabilidad: 'evaluando'
      
    });
       
    this.setState({
      presentToDo: '',
    });
  }


  clearViabilidad() {
    db.ref('/Usuarios/' + this.state.key).remove();
  }

  componentDidMount() {
    LogBox.ignoreLogs(["Setting a timer"]);

    db.ref('/Usuarios/').on('child_added', (snapshot) => {
 
      key = snapshot.key;
      console.log('KEY: ', key)
      
      var user = snapshot.val();
      console.log('Valores: ', user)

      this.setState({
        key: key,
      });
     
    
    })
  } 




  render() {


  
  return (  
       
       <ImageOverlay 
         source={tec2}
         height={height}>

        <View style={{flex:1}}>
          <View  style={{marginTop: '0%', marginBottom: '1%'}}>
                       
              <Text style={{color: '#000',
                      backgroundColor: 'white',
                      fontSize: 15,
                      marginHorizontal: 15,
                      textAlign: 'center',
                      marginTop: '5%',
                      marginBottom: 5,
                      fontWeight: 'bold',
                      padding: 10,
                      borderRadius:0}}>Viabilidad instalación CLIENTE:

              </Text>

          </View>
                   
          
        <View style={{marginTop: '0%', marginBottom: '1%', flex:1}}>

              <TouchableOpacity
              onPress={() => {this.evaluando()}}
              >
              <View
              style={styles.btnContainer0}>
                <Text style={styles.btnText}>Evaluando</Text>
              </View>
            </TouchableOpacity> 

             <TouchableOpacity
              onPress={() => this.viabilidadTotal()}
              >
              <View
                style={styles.btnContainer1}>
                <Icon
                  name="thumbs-up"
                  size={50}
                  color="black"
                  style={styles.btnIcon}/>
    
                <Text style={styles.btnText}>100% de la oferta</Text>
              </View>
            </TouchableOpacity>
         



             <TouchableOpacity
              onPress={() => this.viabilidadParcial()}
              >
              <View
                style={styles.btnContainer2}>
                <Icon
                  name="thumbs-up"
                  size={50}
                  color="black"
                  style={styles.btnIcon}/>
    
                <Text style={styles.btnText}>Oferta a la baja</Text>
              </View>
            </TouchableOpacity>
       

      
             <TouchableOpacity
              onPress={() => this.noViable()}
              >
              <View
                style={styles.btnContainer3}>
                <Icon
                  name="ban"
                  size={50}
                  color="black"
                  style={styles.btnIcon}/>
    
                <Text style={styles.btnText}>No es posible la instalación</Text>
              </View>
            </TouchableOpacity>

            <TouchableOpacity
            onPress={() => this.clearViabilidad()}
            >
            <View
              style={{
  
                justifyContent: 'center',
                borderRadius: 15,
                backgroundColor: 'grey',
                padding: 15,
                textAlign:'center',
                alignItems:'center',
                flexDirection: 'column',
                width:'100%',
                height:'25%',
                marginBottom:'2%', marginTop:'5%'
            
              
              }}>
              
  
              <Text style={styles.btnText}>Borrar viabilidad</Text>
            </View>
          </TouchableOpacity>
        </View>
        </View>
        </ImageOverlay>
        
   
  )}

  
  

}



const styles = StyleSheet.create({

  fondo: {
    width: '100%'
        
  },
  btnContainer0: {
    
    justifyContent: 'center',
    borderRadius: 15,
    backgroundColor: 'grey',
    padding: 15,
    textAlign:'center',
    alignItems:'center',
    flexDirection: 'column',
    width:300,
    height:50,
    marginBottom:'10%', marginTop:'2%'

  
  },
  btnContainer1: {
    
    justifyContent: 'center',
    borderRadius: 15,
    backgroundColor: 'green',
    padding: 15,
    textAlign:'center',
    alignItems:'center',
    flexDirection: 'column',
    width:300,
    height:100,
    marginBottom:'2%', marginTop:'2%'

  
  },

   btnContainer2: {
    
    justifyContent: 'center',
    borderRadius: 15,
    backgroundColor: 'orange',
    padding: 15,
    textAlign:'center',
    alignItems:'center',
    flexDirection: 'column',
    width:300,
    height:100,
    marginBottom:'2%', marginTop:'2%'

  
  },


   btnContainer3: {
   
    justifyContent: 'center',
    borderRadius: 15,
    backgroundColor: 'red',
    padding: 20,
    textAlign:'center',
    alignItems:'center',
    flexDirection: 'column',
    width:300,
    height:110,
    marginBottom:'2%', marginTop:'2%'

  
  },
  btnIcon: {
    height: 50,
    width: 50,
  },
  btnText: {
    fontSize: 18,
    color: '#FAFAFA',
    marginLeft: 0,
    marginTop: 5,
    textAlign:'center',
    fontWeight: 'bold'

  }

});